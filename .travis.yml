#
# Copyright (c) 2017 Bitprim developers (see AUTHORS)
#
# This file is part of Bitprim.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

env:
   global:
     - CONAN_REFERENCE: "bitprim-node-cint/0.1"
     - CONAN_USERNAME: "bitprim"
     - CONAN_LOGIN_USERNAME: "dario-ramos"
     - CONAN_CHANNEL: "stable"
     - CONAN_UPLOAD: "https://api.bintray.com/conan/bitprim/bitprim"

linux: &linux
   os: linux
   sudo: required
   language: cpp
   python: "3.6"
   services:
     - docker

osx: &osx
   os: osx
   language: generic

matrix:
   include:
      - <<: *linux
        env: CONAN_GCC_VERSIONS=4.9 CONAN_DOCKER_IMAGE=lasote/conangcc49

      - <<: *linux
        env: CONAN_GCC_VERSIONS=5.4 CONAN_DOCKER_IMAGE=lasote/conangcc54

      - <<: *linux
        env: CONAN_GCC_VERSIONS=6.3 CONAN_DOCKER_IMAGE=lasote/conangcc63

      - <<: *linux
        env: CONAN_CLANG_VERSIONS=3.9 CONAN_DOCKER_IMAGE=lasote/conanclang39

      - <<: *linux
        env: CONAN_CLANG_VERSIONS=4.0 CONAN_DOCKER_IMAGE=lasote/conanclang40

      - <<: *osx
        osx_image: xcode7.3
        env: CONAN_APPLE_CLANG_VERSIONS=7.3

      - <<: *osx
        osx_image: xcode8.2
        env: CONAN_APPLE_CLANG_VERSIONS=8.0

      - <<: *osx
        osx_image: xcode8.3
        env: CONAN_APPLE_CLANG_VERSIONS=8.1

install:
  - cd ${TRAVIS_BUILD_DIR}
  - chmod +x .travis/install.sh
  - ./.travis/install.sh

script:
  - cd ${TRAVIS_BUILD_DIR}
  - chmod +x .travis/run.sh
  - ./.travis/run.sh

notifications:
  email: false
  webhooks:
    urls: https://webhooks.gitter.im/e/a19dd2b03bf676d2b622
    on_success: change
    on_failure: always




#env:
#   global:
#     - CONAN_REFERENCE: "bitprim-node-cint/0.1"
#     - CONAN_USERNAME: "bitprim"
#     - CONAN_LOGIN_USERNAME: "dario-ramos"
#     - CONAN_CHANNEL: "stable"
#     - CONAN_UPLOAD: "https://api.bintray.com/conan/bitprim/bitprim-node-cint"
#
#linux: &linux
#   os: linux
#   sudo: required
#   language: python
#   python: "3.6"
#   services:
#     - docker
#osx: &osx
#   os: osx
#   language: generic
#matrix:
#   include:
#
#      - <<: *linux
#        env: CONAN_GCC_VERSIONS=4.9 CONAN_DOCKER_IMAGE=lasote/conangcc49
#
#      - <<: *linux
#        env: CONAN_GCC_VERSIONS=5.4 CONAN_DOCKER_IMAGE=lasote/conangcc54
#
#      - <<: *linux
#        env: CONAN_GCC_VERSIONS=6.3 CONAN_DOCKER_IMAGE=lasote/conangcc63
#
#before_install:
#
#  - if [ -n "$GCC_VERSION" ]; then export CXX="g++-${GCC_VERSION}" CC="gcc-${GCC_VERSION}"; fi
#  - if [ -n "$CLANG_VERSION" ]; then export CXX="clang++-${CLANG_VERSION}" CC="clang-${CLANG_VERSION}"; fi
#  - if [ -n "$GCC_VERSION" ]; then export CXX_FLAGS="${CXX_FLAGS} "; fi
#  - if [ -n "$CLANG_VERSION" ]; then export CXX_FLAGS="${CXX_FLAGS} "; fi
#
#install:
#  ############################################################################
#  # All the dependencies are installed in /home/travis/deps/
#  ############################################################################
#  - DEPS_DIR="/home/travis/deps"
#  - mkdir ${DEPS_DIR} && cd ${DEPS_DIR}
#  ############################################################################
#  # Install a recent CMake
#  ############################################################################
#  - CMAKE_URL="https://cmake.org/files/v3.9/cmake-3.9.0-rc5-Linux-x86_64.tar.gz"
#  - mkdir cmake && travis_retry wget --no-check-certificate --quiet -O - ${CMAKE_URL} | tar --strip-components=1 -xz -C cmake
#  - echo 'Cmake 3.9.0 installed';
#  - export PATH=${DEPS_DIR}/cmake/bin:${PATH}
#  ############################################################################
#  # Install a Boost with -fPIC
#  ############################################################################
#  - cd ${DEPS_DIR}
#  - wget -O boost_1_64_0.tar.gz https://sourceforge.net/projects/boost/files/boost/1.64.0/boost_1_64_0.tar.gz/download
#  - tar -xzf boost_1_64_0.tar.gz
#  - cd boost_1_64_0
#  - wget -O boost_bin_fpic.tar.bz2 http://repo.bitprim.org/packages/binary/boost_bin_fpic.tar.bz2
#  - tar -xvjf boost_bin_fpic.tar.bz2
#  - export BOOST_OPTS="-DBOOST_ROOT=/home/travis/deps/boost_1_64_0 -DBOOST_INCLUDEDIR=/home/travis/deps/boost_1_64_0 -DBOOST_LIBRARYDIR=/home/travis/deps/boost_1_64_0/lib"
#  - sudo ldconfig
#  - echo 'Boost 1.64.0 installed';
#
#  - cd ${TRAVIS_BUILD_DIR}
#  - chmod +x .travis/install.sh
#  - ./.travis/install.sh
#
#before_script:
#  ############################################################################
#  # Set the git identity (for pushing the documentation and the benchmarks)
#  ############################################################################
#  - git config --global user.name "Travis bot"
#  - git config --global user.email travis-bot@travis-ci.org
#
#  - if [ -n "$GCC_VERSION" ]; then export CXX_FLAGS="${CXX_FLAGS} "; fi
#  - if [ -n "$CLANG_VERSION" ]; then export CXX_FLAGS="${CXX_FLAGS} "; fi
#
#  ############################################################################
#  # Build and install local deps
#  ############################################################################
#  - cd ${DEPS_DIR}
#  - |
#    function build_project
#    {
#    cd $1
#    mkdir build
#    cd build
#    cmake .. -G "Unix Makefiles" -DCMAKE_CXX_FLAGS="${CXX_FLAGS}" ${BOOST_OPTS} -DENABLE_TESTS=OFF -DWITH_EXAMPLES=OFF -DWITH_REMOTE_DATABASE=OFF -DWITH_REMOTE_BLOCKCHAIN=OFF -DWITH_LITECOIN=OFF -DWITH_TESTS=OFF -DENABLE_MODULE_RECOVERY=ON -DWITH_TOOLS=OFF -DCMAKE_BUILD_TYPE=Debug
#    make -j4
#    sudo make install
#    cd ..
#    cd ..
#    }
#  - git clone 'https://github.com/bitprim/secp256k1' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-core' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-database' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-network' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-consensus' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-blockchain' -b c-api
#  - git clone 'https://github.com/bitprim/bitprim-node' -b c-api
#
#  - build_project secp256k1
#  - build_project bitprim-core
#  - build_project bitprim-network
#  - build_project bitprim-database
#  - build_project bitprim-consensus
#  - build_project bitprim-blockchain
#  - build_project bitprim-node
#
#  ############################################################################
#  # Build this repo
#  ############################################################################
#  - cd ${TRAVIS_BUILD_DIR}
#  - mkdir build
#  - cd build
#  - cmake .. -DENABLE_TESTS=OFF -DWITH_TESTS=OFF -DWITH_TOOLS=OFF -DCMAKE_BUILD_TYPE=$BUILD_TYPE -DCMAKE_CXX_FLAGS="${CXX_FLAGS}" ${BOOST_OPTS}
#
#script:
#  - make -j2
#  - sudo make install
#  - cd ${TRAVIS_BUILD_DIR}
#  - chmod +x .travis/run.sh
#  - ./.travis/run.sh
